name: Install FOSSA CLI
description: Installs the FOSSA CLI and makes it available in \$PATH
inputs:
  version:
    description: Version to install
    default: '3.8.27'
  sha256sum:
    description: The SHA256 checksum for the installer
    default: b427b7eca7704be9aa650d66fe4d9f32e4692407d69a3fe3b747b822e779fb83
runs:
  using: composite
  steps:
    - name: Download archive
      shell: bash
      run: curl -L -o /tmp/fossa.tar.gz https://github.com/fossas/fossa-cli/releases/download/v${{ inputs.version }}/fossa_${{ inputs.version }}_linux_amd64.tar.gz
    - name: Verify checksum
      shell: bash
      run: echo "${{ inputs.sha256sum }} */tmp/fossa.tar.gz" | sha256sum -c -
    - name: Unpack archive
      shell: bash
      run: |
        mkdir -p /opt/fossa/bin
        tar -C /opt/fossa/bin -xvzf /tmp/fossa.tar.gz
    - name: Update PATH
      shell: bash
      run: echo "/opt/fossa/bin" >> ${GITHUB_PATH}
    - name: Clean up download
      shell: bash
      run: rm /tmp/fossa.tar.gz
