name: Install FOSSA CLI
description: Installs the FOSSA CLI and makes it available in \$PATH
inputs:
  version:
    description: Version to install
    default: '3.8.6'
  sha256sum:
    description: The SHA256 checksum for the installer
    default: c5fd475ac7a0c305a58b515d213d5315331f8789a63cc07ee34ad15e8f29a61e
runs:
  using: composite
  steps:
    - name: Download archive
      shell: bash
      run: curl -L -o /tmp/fossa.tar.gz https://github.com/fossas/fossa-cli/releases/download/v${{ inputs.version }}/fossa_${{ inputs.version }}_linux_amd64.tar.gz
    - name: Verify checksum
      shell: bash
      run: echo "${{ inputs.sha256sum }} */tmp/fossa.tar.gz" | sha256sum -c -
    - name: Unpack archive
      shell: bash
      run: |
        mkdir -p /opt/fossa/bin
        tar -C /opt/fossa/bin -xvzf /tmp/fossa.tar.gz
    - name: Update PATH
      shell: bash
      run: echo "/opt/fossa/bin" >> ${GITHUB_PATH}
    - name: Clean up download
      shell: bash
      run: rm /tmp/fossa.tar.gz
